<html>
  <head>
    <title>Oddjob Reference - sql-keeper-service</title>
  </head>
  <body>
  [<a href="../../../index.html">Index</a>]
    <h1>sql-keeper-service</h1>
    <hr/>
Provides a <code><a href='../../../../api/org/oddjob/scheduling/Keeper.html'>org.oddjob.scheduling.Keeper</a></code> that uses a database 
 table.
 <p>
 The keeper uses a simple 'first to insert' a row wins methodology for deciding
 winner and looser. This is quite primitive and decides that any exception 
 from the insert operation is a duplicate key exception and therefore a 
 looser.
 <p>
 A <code><a href='../../../../api/org/oddjob/scheduling/LoosingOutcome.html'>org.oddjob.scheduling.LoosingOutcome</a></code> will continue to Poll the database (for as long
 as it has listeners) until the work is complete. The default polling schedule
 polls every 5 seconds indefinitely. The <code>pollSchedule</code> property
 can be used to poll for a limited time, after which it flags an exception
 state. This could be used by loosing servers to flag the winner is taking
 too long and has possibly crashed.
 <p>
 This is an example of the SQL that would create a suitable table.
 
 <pre><code>
 CREATE TABLE oddjob_grabbable(
   key VARCHAR(32),
   instance VARCHAR(32),
   winner VARCHAR(32),
   complete boolean,
  CONSTRAINT oddjob_pk PRIMARY KEY (key, instance))
 </pre></code>
 
 <p>
 This service does not tidy up the database so rows will grow indefinitely.
 A separate tidy job should be implemented.
    <hr/>
    <h3>Property Summary</h3>
    <table width='100%' border='1' cellpadding='3' cellspacing='0'>
    <tr>
      <td><a href='#property1'>connection</a></td>
      <td>The <a href='../../../org/oddjob/sql/ConnectionType.html'>connection</a> to use.</td>
    </tr>
    <tr>
      <td><a href='#property2'>keeper</a></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td><a href='#property3'>name</a></td>
      <td>The name.</td>
    </tr>
    <tr>
      <td><a href='#property4'>pollSchedule</a></td>
      <td>The schedule to provide the polling interval.</td>
    </tr>
    <tr>
      <td><a href='#property5'>pollerCount</a></td>
      <td>The number of outstanding loosing outcome's 
 polling of the database that are still in progress.</td>
    </tr>
    <tr>
      <td><a href='#property6'>scheduleExecutorService</a></td>
      <td>The scheduling service for polling.</td>
    </tr>
    <tr>
      <td><a href='#property7'>table</a></td>
      <td>The database table name.</td>
    </tr>
    </table>
    <hr/>
    <h3>Example Summary</h3>
    <table width='100%' border='1' cellpadding='3' cellspacing='0'>
    <tr>
      <td><a href='#example1'>Example 1</a></td>
      <td>See the User Guide.</td>
    </tr>
    </table>
    <hr/>
    <h3>Property Detail</h3>
    <a name='property1'><h4>connection</h4></a>
      <table style='font-size:smaller'>
      <tr><td><i>Configured By</i></td><td>ELEMENT</td></tr>
      <tr><td><i>Access</i></td><td>WRITE_ONLY</td></tr>
      <tr><td><i>Required</i></td><td>Yes.</td></tr>
      </table>
      <p>
The <a href='../../../org/oddjob/sql/ConnectionType.html'>connection</a> to use.
      </p>
    <a name='property2'><h4>keeper</h4></a>
      <table style='font-size:smaller'>
      <tr><td><i>Access</i></td><td>READ_ONLY</td></tr>
      </table>
      <p>

      </p>
    <a name='property3'><h4>name</h4></a>
      <table style='font-size:smaller'>
      <tr><td><i>Configured By</i></td><td>ATTRIBUTE</td></tr>
      <tr><td><i>Access</i></td><td>READ_WRITE</td></tr>
      <tr><td><i>Required</i></td><td>No.</td></tr>
      </table>
      <p>
The name.
      </p>
    <a name='property4'><h4>pollSchedule</h4></a>
      <table style='font-size:smaller'>
      <tr><td><i>Configured By</i></td><td>ELEMENT</td></tr>
      <tr><td><i>Access</i></td><td>READ_WRITE</td></tr>
      <tr><td><i>Required</i></td><td>No - defaults to a 5 second {@link IntervalSchedule}.</td></tr>
      </table>
      <p>
The schedule to provide the polling interval.
      </p>
    <a name='property5'><h4>pollerCount</h4></a>
      <table style='font-size:smaller'>
      <tr><td><i>Access</i></td><td>READ_ONLY</td></tr>
      </table>
      <p>
The number of outstanding loosing outcome's 
 polling of the database that are still in progress.
      </p>
    <a name='property6'><h4>scheduleExecutorService</h4></a>
      <table style='font-size:smaller'>
      <tr><td><i>Configured By</i></td><td>ELEMENT</td></tr>
      <tr><td><i>Access</i></td><td>WRITE_ONLY</td></tr>
      <tr><td><i>Required</i></td><td>No - provided by Oddjob.</td></tr>
      </table>
      <p>
The scheduling service for polling.
      </p>
    <a name='property7'><h4>table</h4></a>
      <table style='font-size:smaller'>
      <tr><td><i>Configured By</i></td><td>ATTRIBUTE</td></tr>
      <tr><td><i>Access</i></td><td>READ_WRITE</td></tr>
      <tr><td><i>Required</i></td><td>No.</td></tr>
      </table>
      <p>
The database table name.
      </p>
    <hr/>
    <h3>Examples</h3>
    <a name='example1'><h4>Example 1</h4></a>
    <p>
See the User Guide.
    </p>
    <hr/>
    <font size='-1' align='center'>(c) Rob Gordon 2005 - 2014</font>
	 </body>
  </html>
